<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Entrenador Personal</title>
    <!-- Bibliotecas Externas -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap');
        body { 
            font-family: 'Inter', sans-serif; 
            background-color: #020617; 
            color: white; 
            margin: 0; 
            padding: 0; 
            overflow-x: hidden; 
            -webkit-tap-highlight-color: transparent; 
        }
        .scrollbar-hide::-webkit-scrollbar { display: none; }
        .animate-fade { animation: fadeIn 0.4s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }
        input:focus { border-color: #f97316 !important; }
        /* Efecto de pulsación para botones táctiles */
        button:active { transform: scale(0.96); transition: transform 0.1s; }
    </style>
</head>
<body>
    <div id="root"></div>

    <!-- Firebase SDK v9+ (Modo Compatibilidad) -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- CONFIGURACIÓN DE FIREBASE ---
        const firebaseConfig = {
            apiKey: "AIzaSyDg0nohFAprIYta3Z3IvFGms55PehyxGIM",
            authDomain: "entrenadorpersonal-4e69d.firebaseapp.com",
            projectId: "entrenadorpersonal-4e69d",
            storageBucket: "entrenadorpersonal-4e69d.firebasestorage.app",
            messagingSenderId: "198872357236",
            appId: "1:198872357236:web:c3cd2a7f5caff197847421",
            measurementId: "G-D4X8GVGRXT"
        };

        // Inicialización de los servicios
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();
        const appId = "mientrenador-v3";

        // --- PARÁMETROS SEGÚN TABLA EXCEL ---
        const PHASES = [
            { id: 'calentamiento', label: 'Calentamiento', icon: 'Flame', color: 'bg-orange-500' },
            { id: 'entrenamiento', label: 'Entrenamiento', icon: 'Activity', color: 'bg-red-600' },
            { id: 'estiramientos', label: 'Estiramiento', icon: 'StretchHorizontal', color: 'bg-blue-500' }
        ];

        const DEFAULT_PARAMS = {
            calentamiento: { prep: 20, action: 30, change: 5, rounds: 1, cycles: 1, rest: 0 },
            entrenamiento: { prep: 0, action: 30, change: 5, rounds: 9, cycles: 4, rest: 60 },
            estiramientos: { prep: 0, action: 30, change: 5, rounds: 15, cycles: 1, rest: 0 }
        };

        // --- SISTEMA DE VOZ ---
        const speak = (text) => {
            if (!window.speechSynthesis) return;
            window.speechSynthesis.cancel();
            const msg = new SpeechSynthesisUtterance(text);
            msg.lang = 'es-ES';
            msg.rate = 1.1;
            window.speechSynthesis.speak(msg);
        };

        const formatTime = (s) => {
            const m = Math.floor(s / 60);
            const sec = s % 60;
            return `${m}:${sec.toString().padStart(2, '0')}`;
        };

        // --- COMPONENTE PRINCIPAL ---
        function App() {
            const [user, setUser] = useState(null);
            const [workouts, setWorkouts] = useState([]);
            const [history, setHistory] = useState([]);
            const [view, setView] = useState('home');
            const [selectedWorkout, setSelectedWorkout] = useState(null);
            const [loading, setLoading] = useState(true);
            const [error, setError] = useState(null);

            useEffect(() => {
                return auth.onAuthStateChanged(u => { 
                    setUser(u); 
                    setLoading(false); 
                });
            }, []);

            useEffect(() => {
                if (!user) return;
                const path = `artifacts/${appId}/users/${user.uid}`;
                
                const unsubW = db.collection(path + '/workouts').onSnapshot(s => {
                    setWorkouts(s.docs.map(d => ({id: d.id, ...d.data()})).sort((a,b) => new Date(b.createdAt) - new Date(a.createdAt)));
                });
                
                const unsubH = db.collection(path + '/history').onSnapshot(s => {
                    setHistory(s.docs.map(d => ({id: d.id, ...d.data()})).sort((a,b) => new Date(b.completedAt) - new Date(a.completedAt)));
                });
                
                return () => { unsubW(); unsubH(); };
            }, [user]);

            const onSaveWorkout = async (name, phases) => {
                let total = phases.calentamiento.prep;
                Object.values(phases).forEach(p => {
                    total += (p.cycles * (p.rounds * (p.action + p.change))) + ((p.cycles - 1) * p.rest);
                });
                await db.collection(`artifacts/${appId}/users/${user.uid}/workouts`).add({ 
                    name, phases, totalTime: total, createdAt: new Date().toISOString() 
                });
            };

            const onCompleteWorkout = async (name, time) => {
                await db.collection(`artifacts/${appId}/users/${user.uid}/history`).add({ 
                    workoutName: name, totalTime: time, completedAt: new Date().toISOString() 
                });
            };

            if (loading) return (
                <div className="h-screen flex items-center justify-center bg-slate-950">
                    <div className="animate-spin rounded-full h-10 w-10 border-b-2 border-orange-500"></div>
                </div>
            );

            if (!user) return <AuthView setError={setError} error={error} />;

            return (
                <div className="max-w-md mx-auto min-h-screen p-4 flex flex-col bg-slate-950">
                    {error && (
                        <div className="bg-red-600 text-white p-3 rounded-xl mb-4 text-[10px] font-bold uppercase flex justify-between animate-fade shadow-lg">
                            <span>{error}</span>
                            <button onClick={() => setError(null)}>✕</button>
                        </div>
                    )}
                    
                    {view === 'home' && <HomeView workouts={workouts} user={user} setView={setView} setWorkout={setSelectedWorkout} />}
                    {view === 'create' && <CreateView onCancel={() => setView('home')} onSave={onSaveWorkout} />}
                    {view === 'play' && <PlayerView workout={selectedWorkout} onExit={() => setView('home')} onComplete={onCompleteWorkout} />}
                    {view === 'history' && <HistoryView history={history} onBack={() => setView('home')} user={user} />}
                </div>
            );
        }

        // --- VISTAS ESPECÍFICAS ---

        function AuthView({ setError, error }) {
            const [isLogin, setIsLogin] = useState(true);
            const [email, setEmail] = useState('');
            const [password, setPassword] = useState('');
            const [working, setWorking] = useState(false);

            useEffect(() => { lucide.createIcons(); }, [isLogin]);

            const handleAuth = async (e) => {
                e.preventDefault();
                setWorking(true);
                setError(null);
                try {
                    if (isLogin) await auth.signInWithEmailAndPassword(email.trim(), password);
                    else await auth.createUserWithEmailAndPassword(email.trim(), password);
                } catch (err) { 
                    setError(err.code === 'auth/invalid-credential' ? "DATOS INCORRECTOS" : err.message); 
                } finally { setWorking(false); }
            };

            return (
                <div className="h-screen flex flex-col justify-center p-8 text-center animate-fade">
                    <div className="bg-orange-500 w-20 h-20 rounded-[2.2rem] flex items-center justify-center mx-auto mb-6 shadow-[0_15px_40px_rgba(249,115,22,0.3)]">
                        <i data-lucide="activity" className="text-white w-10 h-10"></i>
                    </div>
                    <h1 className="text-3xl font-black uppercase mb-1 italic tracking-tighter">Entrenador Personal</h1>
                    <p className="text-slate-500 text-[10px] font-black uppercase tracking-widest mb-10">
                        {isLogin ? 'Accede a tu plan' : 'Crea tu cuenta'}
                    </p>
                    <form onSubmit={handleAuth} className="space-y-4">
                        <input type="email" placeholder="CORREO" className="w-full bg-slate-900 border-2 border-slate-800 p-5 rounded-2xl outline-none font-bold text-sm shadow-inner" value={email} onChange={e => setEmail(e.target.value)} required />
                        <input type="password" placeholder="CONTRASEÑA" className="w-full bg-slate-900 border-2 border-slate-800 p-5 rounded-2xl outline-none font-bold text-sm shadow-inner" value={password} onChange={e => setPassword(e.target.value)} required />
                        <button type="submit" disabled={working} className="w-full bg-orange-500 py-6 rounded-full font-black uppercase shadow-xl active:scale-95 disabled:opacity-50">
                            {working ? '...' : (isLogin ? 'ENTRAR' : 'REGISTRARME')}
                        </button>
                    </form>
                    <button onClick={() => setIsLogin(!isLogin)} className="mt-8 text-slate-400 text-[10px] font-black uppercase border-b-2 border-orange-500 pb-1 italic">
                        {isLogin ? '¿QUIERO REGISTRARME?' : 'YA TENGO CUENTA'}
                    </button>
                </div>
            );
        }

        function HomeView({ workouts, user, setView, setWorkout }) {
            useEffect(() => { lucide.createIcons(); }, [workouts]);
            return (
                <div className="flex-1 flex flex-col pt-6 animate-fade">
                    <header className="flex justify-between items-center mb-8 px-2">
                        <div className="flex items-center gap-3">
                            <div className="bg-slate-900 p-3 rounded-2xl border border-white/5 shadow-xl"><i data-lucide="activity" className="text-orange-500"></i></div>
                            <div>
                                <h1 className="text-2xl font-black italic uppercase leading-none">Mi Plan</h1>
                                <p className="text-slate-500 text-[8px] font-bold truncate max-w-[150px]">{user.email}</p>
                            </div>
                        </div>
                        <div className="flex gap-2">
                            <button onClick={() => setView('history')} className="bg-slate-900 p-4 rounded-2xl border border-white/5 text-slate-400 active:scale-90 transition-transform"><i data-lucide="history"></i></button>
                            <button onClick={() => auth.signOut()} className="bg-slate-900 p-4 rounded-2xl border border-white/5 text-red-500 active:scale-90 transition-transform"><i data-lucide="log-out"></i></button>
                        </div>
                    </header>
                    <div className="flex-1 space-y-4 overflow-y-auto pb-28 scrollbar-hide px-1">
                        {workouts.length === 0 ? 
                            <div className="text-center p-20 opacity-20 italic font-black uppercase text-[10px] flex flex-col items-center gap-3">
                                <i data-lucide="activity" className="w-10 h-10"></i>
                                <span>Sin rutinas guardadas</span>
                            </div> :
                            workouts.map(w => (
                                <div key={w.id} className="bg-slate-900/60 p-6 rounded-[2rem] border border-slate-800/50 flex justify-between items-center shadow-lg active:scale-98 transition-all">
                                    <div className="flex-1 cursor-pointer" onClick={() => { setWorkout(w); setView('play'); }}>
                                        <h3 className="font-black uppercase italic truncate text-sm mb-1">{w.name}</h3>
                                        <span className="text-[10px] font-black text-orange-400 uppercase bg-orange-500/10 px-2 py-0.5 rounded-lg">{formatTime(w.totalTime)}</span>
                                    </div>
                                    <div className="flex gap-2">
                                        <button onClick={() => { setWorkout(w); setView('play'); }} className="bg-white text-black p-4 rounded-xl shadow-xl active:scale-90"><i data-lucide="play" fill="black"></i></button>
                                        <button onClick={() => db.doc(`artifacts/${appId}/users/${user.uid}/workouts/${w.id}`).delete()} className="bg-slate-800 p-4 rounded-xl text-slate-600 active:scale-90 transition-colors hover:text-red-500"><i data-lucide="trash-2"></i></button>
                                    </div>
                                </div>
                            ))
                        }
                    </div>
                    <button onClick={() => setView('create')} className="fixed bottom-8 left-8 right-8 max-w-sm mx-auto bg-orange-500 py-6 rounded-full font-black uppercase shadow-[0_20px_50px_rgba(249,115,22,0.3)] flex items-center justify-center gap-2 z-10">
                        <i data-lucide="plus" stroke-width="4"></i> NUEVA RUTINA
                    </button>
                </div>
            );
        }

        function CreateView({ onCancel, onSave }) {
            const [name, setName] = useState('');
            const [phases, setPhases] = useState(DEFAULT_PARAMS);
            const [saving, setSaving] = useState(false);
            useEffect(() => { lucide.createIcons(); }, []);
            const update = (p, f, v) => setPhases(prev => ({...prev, [p]: {...prev[p], [f]: parseInt(v) || 0}}));
            const handle = async () => { 
                if (!name.trim() || saving) return; 
                setSaving(true); 
                try { await onSave(name, phases); onCancel(); } 
                catch (e) { alert("Error al guardar"); setSaving(false); } 
            };

            return (
                <div className="flex-1 flex flex-col pb-24 animate-fade">
                    <header className="flex items-center gap-4 py-6 px-1">
                        <button onClick={onCancel} className="bg-slate-900 p-3 rounded-xl active:scale-90"><i data-lucide="chevron-left"></i></button>
                        <h1 className="text-xl font-black italic uppercase tracking-tighter">Nueva Rutina</h1>
                    </header>
                    <div className="space-y-5 overflow-y-auto scrollbar-hide pb-10">
                        <div className="px-1">
                            <input type="text" placeholder="NOMBRE DE RUTINA" className="w-full bg-slate-900 border-2 border-slate-800 p-5 rounded-2xl focus:border-orange-500 outline-none font-black text-center uppercase tracking-widest" value={name} onChange={e => setName(e.target.value)} />
                        </div>
                        {PHASES.map((p, idx) => (
                            <div key={p.id} className="bg-slate-900/40 p-5 rounded-[2rem] space-y-4 border border-white/5 shadow-inner">
                                <div className="flex items-center gap-2 border-b border-white/5 pb-2">
                                    <div className={`${p.color} p-2 rounded-lg`}><i data-lucide={p.icon.toLowerCase()} className="w-4 h-4 text-white"></i></div>
                                    <span className="font-black uppercase italic text-sm">{p.label}</span>
                                </div>
                                <div className="grid grid-cols-2 gap-3">
                                    {idx === 0 && <div className="col-span-2"><InputField label="Prep. Inicial (s)" val={phases[p.id].prep} set={v => update(p.id, 'prep', v)} /></div>}
                                    <InputField label="Acción (s)" val={phases[p.id].action} set={v => update(p.id, 'action', v)} />
                                    <InputField label="Cambio (s)" val={phases[p.id].change} set={v => update(p.id, 'change', v)} />
                                    <InputField label="Rondas" val={phases[p.id].rounds} set={v => update(p.id, 'rounds', v)} />
                                    <InputField label="Ciclos" val={phases[p.id].cycles} set={v => update(p.id, 'cycles', v)} />
                                    <div className="col-span-2"><InputField label="Descanso (s)" val={phases[p.id].rest} set={v => update(p.id, 'rest', v)} /></div>
                                </div>
                            </div>
                        ))}
                    </div>
                    <div className="fixed bottom-0 left-0 right-0 p-6 bg-slate-950/95 border-t border-white/5 z-20">
                        <button onClick={handle} disabled={!name || saving} className="w-full bg-white text-black py-6 rounded-full font-black uppercase shadow-2xl active:scale-95 disabled:opacity-30 italic">
                            {saving ? 'GUARDANDO...' : 'GUARDAR RUTINA'}
                        </button>
                    </div>
                </div>
            );
        }

        function InputField({ label, val, set }) {
            return (
                <div className="flex flex-col items-center">
                    <span className="text-[8px] font-bold uppercase opacity-40 mb-1">{label}</span>
                    <input type="number" className="w-full bg-slate-800/40 p-4 rounded-xl text-center font-black text-lg outline-none transition-all shadow-inner focus:bg-slate-800" value={val} onChange={e => set(e.target.value)} />
                </div>
            );
        }

        function PlayerView({ workout, onExit, onComplete }) {
            const [status, setStatus] = useState('paused');
            const [idx, setIdx] = useState(0);
            const [timeLeft, setTimeLeft] = useState(0);
            const [elapsed, setElapsed] = useState(0);
            const [steps, setSteps] = useState([]);
            const savedRef = useRef(false);

            useEffect(() => {
                const s = [];
                if (workout.phases.calentamiento.prep > 0) s.push({ type: 'Prepárate', seconds: workout.phases.calentamiento.prep, color: 'bg-slate-800', phase: 'Calentamiento' });
                PHASES.forEach(p => {
                    const c = workout.phases[p.id];
                    for (let cy = 1; cy <= c.cycles; cy++) {
                        for (let r = 1; r <= c.rounds; r++) {
                            if (c.action > 0) s.push({ type: 'Entrena', seconds: c.action, color: 'bg-emerald-600', phase: p.label, r, tr: c.rounds, cy });
                            if (r < c.rounds && c.change > 0) s.push({ type: 'Cambio', seconds: c.change, color: 'bg-orange-500', phase: p.label, r, tr: c.rounds, cy });
                        }
                        if (cy < c.cycles && c.rest > 0) s.push({ type: 'Cambio', seconds: c.rest, color: 'bg-rose-600', phase: p.label, r: 'Rest', tr: c.rounds, cy });
                    }
                });
                setSteps(s);
                if (s.length > 0) setTimeLeft(s[0].seconds);
                setTimeout(() => lucide.createIcons(), 100);
            }, [workout]);

            useEffect(() => {
                if (status !== 'running') return;
                if (timeLeft === steps[idx]?.seconds) speak(steps[idx].type);
                if (timeLeft <= 3 && timeLeft > 0) speak(timeLeft.toString());
            }, [timeLeft, status]);

            useEffect(() => {
                let timer = null;
                if (status === 'running') {
                    timer = setInterval(() => {
                        setElapsed(e => e + 1);
                        if (timeLeft > 0) setTimeLeft(t => t - 1);
                        else {
                            if (idx < steps.length - 1) { setIdx(i => i + 1); setTimeLeft(steps[idx+1].seconds); }
                            else { setStatus('finished'); if (!savedRef.current) { onComplete(workout.name, elapsed + 1); savedRef.current = true; } speak("¡Entrenamiento completado!"); }
                        }
                    }, 1000);
                }
                return () => clearInterval(timer);
            }, [status, timeLeft]);

            useEffect(() => { lucide.createIcons(); }, [status, idx]);

            if (status === 'finished') return (
                <div className="h-screen flex flex-col items-center justify-center p-8 animate-fade text-center">
                    <div className="bg-emerald-500 w-24 h-24 rounded-full flex items-center justify-center mb-8 shadow-[0_0_50px_rgba(16,185,129,0.3)] animate-bounce"><i data-lucide="check" className="w-12 h-12 text-white"></i></div>
                    <h1 className="text-4xl font-black italic uppercase mb-10 tracking-tighter">¡LOGRADO!</h1>
                    <div className="bg-slate-900 p-8 rounded-[2.5rem] w-full mb-10 shadow-2xl border border-white/5 uppercase italic">
                        <p className="text-[8px] font-black opacity-40 tracking-widest mb-2">Tiempo Total</p>
                        <p className="text-5xl font-black text-emerald-400 tabular-nums leading-none pt-2">{formatTime(elapsed)}</p>
                    </div>
                    <button onClick={onExit} className="w-full bg-white text-black py-6 rounded-full font-black uppercase active:scale-95 shadow-xl italic tracking-widest">Volver al Inicio</button>
                </div>
            );

            const curr = steps[idx];
            return (
                <div className={`h-screen -m-4 flex flex-col transition-colors duration-1000 ${curr?.color || 'bg-slate-950'} relative overflow-hidden`}>
                    <div className="p-6 pt-10 flex justify-between items-center z-20">
                        <button onClick={onExit} className="bg-black/20 p-4 rounded-2xl active:scale-90 backdrop-blur-md"><i data-lucide="chevron-left" className="w-6 h-6"></i></button>
                        <div className="text-center flex-1 mx-4">
                            <p className="text-[8px] font-black uppercase opacity-60 mb-1 italic leading-none tracking-widest">{curr?.phase}</p>
                            <div className="flex items-center justify-center gap-2">
                                <span className="font-black uppercase italic text-xs truncate max-w-[100px]">{workout.name}</span>
                                <div className="bg-white/20 px-2 py-0.5 rounded-full text-[8px] font-black backdrop-blur-md flex items-center gap-1 border border-white/10 shadow-sm"><i data-lucide="timer" className="w-3 h-3"></i><span className="tabular-nums pt-0.5">{formatTime(elapsed)}</span></div>
                            </div>
                        </div>
                        <div className="bg-black/20 p-4 rounded-2xl opacity-40 shadow-sm"><i data-lucide="volume-2" className="w-6 h-6"></i></div>
                    </div>
                    <div className="flex-1 flex flex-col items-center justify-center relative z-10 pt-10 px-2 animate-fade">
                        <div className="text-[14rem] font-black leading-none tabular-nums drop-shadow-[0_20px_60px_rgba(0,0,0,0.5)] tracking-tighter">{timeLeft}</div>
                        <div className="mt-10 flex gap-4 w-full max-w-[300px] px-2 italic">
                            <div className="flex-1 bg-black/30 p-5 rounded-[1.8rem] flex flex-col items-center backdrop-blur-md border border-white/5"><span className="text-[8px] font-black uppercase opacity-40 mb-1 leading-none tracking-widest italic">Rondas</span><span className="text-2xl font-black">{curr?.r || 1}/{curr?.tr || 1}</span></div>
                            <div className="flex-1 bg-black/30 p-5 rounded-[1.8rem] flex flex-col items-center backdrop-blur-md border border-white/5"><span className="text-[8px] font-black uppercase opacity-40 mb-1 leading-none tracking-widest italic">Ciclos</span><span className="text-2xl font-black">{curr?.cy || 1}</span></div>
                        </div>
                    </div>
                    <div className="p-10 pb-24 flex justify-center gap-8 z-20">
                        <button onClick={() => setStatus(s => s === 'running' ? 'paused' : 'running')} className="bg-white text-black w-28 h-28 rounded-full flex items-center justify-center shadow-[0_20px_50px_rgba(0,0,0,0.4)] active:scale-90 transition-all">{status === 'running' ? <i data-lucide="pause" className="w-12 h-12"></i> : <i data-lucide="play" className="w-12 h-12 ml-2 text-black"></i>}</button>
                        <button onClick={() => { if (idx < steps.length - 1) { setIdx(i => i + 1); setTimeLeft(steps[idx+1].seconds); } }} className="bg-black/20 w-16 h-16 rounded-full flex items-center justify-center active:scale-90 shadow-xl self-center border border-white/5"><i data-lucide="skip-forward" className="w-6 h-6"></i></button>
                    </div>
                    <div className="h-2 w-full bg-black/40 fixed bottom-0 left-0 z-30 shadow-[0_-5px_15px_black]"><div className="h-full bg-white transition-all duration-300 shadow-[0_0_20px_white]" style={{ width: `${(idx / steps.length) * 100}%` }}></div></div>
                </div>
            );
        }

        function HistoryView({ history, onBack, user }) {
            useEffect(() => { lucide.createIcons(); }, [history]);
            return (
                <div className="flex-1 flex flex-col pt-6 animate-fade">
                    <header className="flex items-center gap-4 mb-10 px-2">
                        <button onClick={onBack} className="bg-slate-900 p-4 rounded-xl active:scale-90 shadow-lg border border-white/5"><i data-lucide="chevron-left"></i></button>
                        <h1 className="text-3xl font-black italic uppercase tracking-tighter leading-none">Historial</h1>
                    </header>
                    <div className="space-y-4 overflow-y-auto flex-1 pb-10 scrollbar-hide px-1">
                        {history.length === 0 ? <p className="text-center p-20 opacity-20 italic font-black uppercase text-[10px] tracking-widest">Sin registros</p> :
                            history.map(e => (
                                <div key={e.id} className="bg-slate-900/60 p-6 rounded-[2rem] border border-slate-800/50 flex justify-between items-center shadow-lg active:scale-[0.98] transition-all group">
                                    <div className="flex-1 pr-4">
                                        <h3 className="font-black uppercase italic text-sm mb-1 truncate tracking-tight">{e.workoutName}</h3>
                                        <div className="flex gap-4 items-center opacity-50 italic">
                                            <div className="flex items-center gap-1.5"><i data-lucide="calendar" className="w-3.5 h-3.5 text-orange-500"></i><span className="text-[9px] font-black uppercase tracking-tighter">{new Date(e.completedAt).toLocaleDateString()}</span></div>
                                            <div className="flex items-center gap-1.5"><i data-lucide="clock" className="w-3.5 h-3.5 text-emerald-500"></i><span className="text-[9px] font-black uppercase tracking-tighter">{formatTime(e.totalTime)}</span></div>
                                        </div>
                                    </div>
                                    <button onClick={() => db.doc(`artifacts/${appId}/users/${user.uid}/history/${e.id}`).delete()} className="text-slate-600 hover:text-red-500 p-3 active:scale-90 transition-all opacity-40 group-hover:opacity-100"><i data-lucide="trash-2" className="w-5 h-5"></i></button>
                                </div>
                            ))
                        }
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>